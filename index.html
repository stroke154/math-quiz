<!DOCTYPE html>
<html lang="en">
<head>
  <title>Super Simple Math Quiz</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f8ff;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    
    .container {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      max-width: 500px;
      width: 100%;
    }
    
    h1 {
      color: #4169e1;
      text-align: center;
    }
    
    .screen {
      display: none;
    }
    
    .screen.active {
      display: block;
    }
    
    #problem {
      font-size: 2rem;
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
      color: #4169e1;
    }
    
    .timer {
      text-align: right;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .progress {
      background-color: #e0e0e0;
      border-radius: 10px;
      height: 10px;
      margin-bottom: 20px;
    }
    
    .progress-bar {
      background-color: #4169e1;
      height: 10px;
      border-radius: 10px;
      width: 100%;
      transition: width 1s linear;
    }
    
    input[type="number"] {
      display: block;
      margin: 0 auto;
      padding: 10px;
      font-size: 1.5rem;
      width: 100px;
      text-align: center;
      border: 2px solid #4169e1;
      border-radius: 5px;
    }
    
    button {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      background-color: #4169e1;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
    }
    
    button:hover {
      background-color: #3151b5;
    }
    
    .result-item {
      padding: 10px;
      margin: 5px 0;
      border-radius: 5px;
    }
    
    .correct {
      background-color: #e6ffe6;
    }
    
    .incorrect {
      background-color: #ffe6e6;
    }
    
    .difficulty-option {
      padding: 10px;
      margin: 10px 0;
      border: 2px solid #e0e0e0;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .difficulty-option:hover {
      border-color: #4169e1;
    }
    
    .difficulty-option.selected {
      border-color: #4169e1;
      background-color: #f0f8ff;
    }
    
    .loading {
      text-align: center;
      font-size: 1.2rem;
      color: #4169e1;
    }
    
    #error-message {
      color: red;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Loading Screen -->
    <div id="loading-screen" class="screen active">
      <div class="loading">Loading Math Quiz...</div>
      <div id="error-message"></div>
    </div>
    
    <!-- Start Screen -->
    <div id="start-screen" class="screen">
      <h1>Math Quiz for Kids</h1>
      <p style="text-align: center;">Test your math skills with fun problems!</p>
      
      <div>
        <h3>Select Difficulty:</h3>
        <div id="difficulty-options">
          <div class="difficulty-option selected" data-difficulty="easy">
            <strong>Easy</strong>
            <p>Numbers up to 10, only addition and subtraction</p>
          </div>
          
          <div class="difficulty-option" data-difficulty="medium">
            <strong>Medium</strong>
            <p>Numbers up to 20, addition, subtraction, and multiplication</p>
          </div>
          
          <div class="difficulty-option" data-difficulty="hard">
            <strong>Hard</strong>
            <p>Numbers up to 50, all operations including division</p>
          </div>
        </div>
      </div>
      
      <button id="start-button">Start Quiz</button>
    </div>
    
    <!-- Quiz Screen -->
    <div id="quiz-screen" class="screen">
      <div class="timer">Time: <span id="time-display">60</span>s</div>
      <div class="progress">
        <div id="progress-bar" class="progress-bar"></div>
      </div>
      
      <div id="problem-counter">Problem 1 of 10</div>
      <div id="problem">5 + 3 = ?</div>
      
      <input type="number" id="answer-input">
      <button id="submit-button">Submit</button>
    </div>
    
    <!-- Results Screen -->
    <div id="results-screen" class="screen">
      <h1>Quiz Results</h1>
      
      <div style="text-align: center; margin: 20px 0;">
        <div id="score" style="font-size: 2rem; font-weight: bold;">0/10</div>
        <div id="percentage">0%</div>
        <div id="message">Keep practicing!</div>
      </div>
      
      <div id="results-list"></div>
      
      <div style="display: flex; justify-content: space-between; margin-top: 20px;">
        <button id="menu-button">Main Menu</button>
        <button id="retry-button">Try Again</button>
      </div>
    </div>
  </div>
  
  <script>
    // Wait for page to fully load before executing script
    window.onload = function() {
      try {
        // Show loading screen for just a moment to ensure everything is ready
        setTimeout(function() {
          document.getElementById('loading-screen').classList.remove('active');
          document.getElementById('start-screen').classList.add('active');
        }, 500);
        
        // Game configuration
        const DIFFICULTY = {
          easy: { maxNum: 10, operations: ['+', '-'], time: 60 },
          medium: { maxNum: 20, operations: ['+', '-', '×'], time: 90 },
          hard: { maxNum: 50, operations: ['+', '-', '×', '÷'], time: 120 }
        };
        
        // Game state
        let state = {
          difficulty: 'easy',
          problems: [],
          currentIndex: 0,
          score: 0,
          timeLeft: DIFFICULTY.easy.time,
          timer: null,
          answers: {}
        };
        
        // Get DOM elements
        const difficultyOptions = document.querySelectorAll('.difficulty-option');
        const startButton = document.getElementById('start-button');
        const submitButton = document.getElementById('submit-button');
        const menuButton = document.getElementById('menu-button');
        const retryButton = document.getElementById('retry-button');
        const answerInput = document.getElementById('answer-input');
        const timeDisplay = document.getElementById('time-display');
        const progressBar = document.getElementById('progress-bar');
        const problemDisplay = document.getElementById('problem');
        const problemCounter = document.getElementById('problem-counter');
        
        // Set up difficulty selection
        difficultyOptions.forEach(option => {
          option.addEventListener('click', function() {
            // Remove selected class from all options
            difficultyOptions.forEach(opt => {
              opt.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            this.classList.add('selected');
            
            // Update difficulty in game state
            state.difficulty = this.getAttribute('data-difficulty');
          });
        });
        
        // Helper function to get a random number
        function getRandomNumber(min, max) {
          return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Generate a problem based on difficulty
        function generateProblem(difficulty) {
          const config = DIFFICULTY[difficulty];
          const operation = config.operations[Math.floor(Math.random() * config.operations.length)];
          
          let num1, num2, answer;
          
          switch(operation) {
            case '+':
              num1 = getRandomNumber(1, config.maxNum);
              num2 = getRandomNumber(1, config.maxNum);
              answer = num1 + num2;
              break;
            case '-':
              num1 = getRandomNumber(1, config.maxNum);
              num2 = getRandomNumber(1, num1); // Ensure positive result
              answer = num1 - num2;
              break;
            case '×':
              num1 = getRandomNumber(1, Math.floor(config.maxNum / 5));
              num2 = getRandomNumber(1, Math.floor(config.maxNum / 5));
              answer = num1 * num2;
              break;
            case '÷':
              num2 = getRandomNumber(1, 10);
              answer = getRandomNumber(1, Math.floor(config.maxNum / 5));
              num1 = num2 * answer; // Ensure clean division
              break;
          }
          
          return {
            num1: num1,
            num2: num2,
            operation: operation,
            answer: answer
          };
        }
        
        // Update timer display
        function updateTimer() {
          timeDisplay.textContent = state.timeLeft;
          
          // Update progress bar
          const percentage = (state.timeLeft / DIFFICULTY[state.difficulty].time) * 100;
          progressBar.style.width = percentage + '%';
          
          // Change color when time is running out
          if (state.timeLeft <= 10) {
            progressBar.style.backgroundColor = 'red';
            timeDisplay.style.color = 'red';
          }
        }
        
        // Display the current problem
        function displayProblem() {
          const problem = state.problems[state.currentIndex];
          problemCounter.textContent = `Problem ${state.currentIndex + 1} of ${state.problems.length}`;
          problemDisplay.textContent = `${problem.num1} ${problem.operation} ${problem.num2} = ?`;
          answerInput.value = '';
          answerInput.focus();
        }
        
        // Start the quiz
        function startQuiz() {
          // Hide start screen and show quiz screen
          document.getElementById('start-screen').classList.remove('active');
          document.getElementById('quiz-screen').classList.add('active');
          
          // Generate problems
          state.problems = [];
          for (let i = 0; i < 10; i++) {
            state.problems.push(generateProblem(state.difficulty));
          }
          
          // Reset state
          state.currentIndex = 0;
          state.score = 0;
          state.timeLeft = DIFFICULTY[state.difficulty].time;
          state.answers = {};
          
          // Display first problem
          displayProblem();
          
          // Start timer
          updateTimer();
          clearInterval(state.timer);
          state.timer = setInterval(function() {
            state.timeLeft--;
            updateTimer();
            
            if (state.timeLeft <= 0) {
              clearInterval(state.timer);
              showResults();
            }
          }, 1000);
        }
        
        // Submit an answer
        function submitAnswer() {
          const userAnswer = parseInt(answerInput.value);
          
          if (isNaN(userAnswer)) {
            return; // Don't submit if input is not a number
          }
          
          const problem = state.problems[state.currentIndex];
          const isCorrect = userAnswer === problem.answer;
          
          // Record answer
          state.answers[state.currentIndex] = {
            userAnswer: userAnswer,
            isCorrect: isCorrect
          };
          
          // Update score
          if (isCorrect) {
            state.score++;
          }
          
          // Move to next problem or show results
          if (state.currentIndex < state.problems.length - 1) {
            state.currentIndex++;
            displayProblem();
          } else {
            showResults();
          }
        }
        
        // Show results
        function showResults() {
          // Stop timer
          clearInterval(state.timer);
          
          // Hide quiz screen and show results screen
          document.getElementById('quiz-screen').classList.remove('active');
          document.getElementById('results-screen').classList.add('active');
          
          // Update score display
          const scoreElement = document.getElementById('score');
          const percentageElement = document.getElementById('percentage');
          const messageElement = document.getElementById('message');
          
          scoreElement.textContent = `${state.score}/${state.problems.length}`;
          
          const percentage = (state.score / state.problems.length) * 100;
          percentageElement.textContent = `${Math.round(percentage)}%`;
          
          // Set message based on score
          if (percentage >= 90) {
            messageElement.textContent = 'Amazing! You're a math genius! 🏆';
          } else if (percentage >= 70) {
            messageElement.textContent = 'Great job! Very impressive! 🌟';
          } else if (percentage >= 50) {
            messageElement.textContent = 'Good effort! Keep practicing! 👍';
          } else {
            messageElement.textContent = 'Nice try! Let's practice more and try again! 💪';
          }
          
          // Show results list
          const resultsList = document.getElementById('results-list');
          resultsList.innerHTML = '';
          
          state.problems.forEach((problem, index) => {
            const answer = state.answers[index] || {};
            
            const resultItem = document.createElement('div');
            resultItem.className = `result-item ${answer.isCorrect ? 'correct' : 'incorrect'}`;
            
            resultItem.innerHTML = `
              <div>${problem.num1} ${problem.operation} ${problem.num2} = ${problem.answer}</div>
              ${answer.userAnswer !== undefined ? 
                `<div>Your answer: ${answer.userAnswer} ${answer.isCorrect ? '✓' : '✗'}</div>` : 
                '<div>No answer provided ✗</div>'}
            `;
            
            resultsList.appendChild(resultItem);
          });
        }
        
        // Return to main menu
        function goToMainMenu() {
          document.getElementById('results-screen').classList.remove('active');
          document.getElementById('start-screen').classList.add('active');
        }
        
        // Add event listeners
        startButton.addEventListener('click', startQuiz);
        
        submitButton.addEventListener('click', submitAnswer);
        
        answerInput.addEventListener('keypress', function(event) {
          if (event.key === 'Enter') {
            submitAnswer();
          }
        });
        
        menuButton.addEventListener('click', goToMainMenu);
        
        retryButton.addEventListener('click', startQuiz);
        
      } catch(error) {
        console.error('Error in math quiz:', error);
        document.getElementById('error-message').textContent = 
          'An error occurred: ' + error.message + '. Please refresh the page.';
      }
    };
  </script>
</body>
</html>
